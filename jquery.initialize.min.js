(function($){"use strict";var MutationSelectorObserver=function(selector,callback,options){this.selector=selector;this.callback=callback;this.options=options};var mtypes=["childList","attributes"];var msobservers=[];msobservers.initialize=function(selector,callback,options){var seen=[];var callbackOnce=function(){if(seen.indexOf(this)==-1){seen.push(this);$(this).each(callback)}};$(options.target).find(selector).each(callbackOnce);var msobserver=new MutationSelectorObserver(selector,callbackOnce,options);this.push(msobserver);var observer=new MutationObserver(function(mutations){var matches=[];function add(match){matches.push(match)}for(var m=0;m<mutations.length;m++){if($.inArray(mutations[m].type,mtypes)==-1)continue;if(msobserver.options.scanMode=="target"){msobserver.options.target.querySelectorAll(msobserver.selector).forEach(add)}else if(msobserver.options.scanMode=="descendants"){if(mutations[m].type=="attributes"){mutations[m].target.querySelectorAll(msobserver.selector).forEach(add);if(mutations[m].target.matches(msobserver.selector)){matches.push(mutations[m].target)}}else if(mutations[m].type=="childList"){for(var n=0;n<mutations[m].addedNodes.length;n++){mutations[m].addedNodes[n].querySelectorAll(msobserver.selector).forEach(add);if(mutations[m].addedNodes[n].matches(msobserver.selector)){matches.push(mutations[m].addedNodes[n])}}}}else if(msobserver.options.scanMode=="exact"){if(mutations[m].type=="attributes"){if(mutations[m].target.matches(msobserver.selector))matches.push(mutations[m].target)}else if(mutations[m].type=="childList"){for(var n=0;n<mutations[m].addedNodes.length;n++){if(mutations[m].addedNodes[n].matches(msobserver.selector))matches.push(mutations[m].addedNodes[n])}}}}matches.forEach(function(match){$(match).each(msobserver.callback)})});observer.observe(options.target,{childList:true,subtree:true,attributes:true})};$.fn.initialize=function(callback,options){msobservers.initialize(this.selector,callback,$.extend({},$.initialize.defaults,options))};$.initialize=function(selector,callback,options){msobservers.initialize(selector,callback,$.extend({},$.initialize.defaults,options))};$.initialize.defaults={scanMode:"target",target:document.documentElement}})(jQuery);
